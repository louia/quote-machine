{% extends "base.html.twig" %}

{% block title %}Liste de citations{% endblock %}
{% block hero %}Liste de citations{% endblock %}

{% block body %}
    <div class="columns">
        <div class="column">
        </div>
        <div class="column is-four-fifths">
            {% if (query != '' and pagination.getTotalItemCount == 0) or pagination.getTotalItemCount > 0 %}
                <form method="GET" name="name">
                    <div class="field has-addons">
                        <div class="control">
                            <input class="input" name="name" type="text" placeholder="Rechercher..."
                                   value="{{ query }}">
                        </div>
                        <div class="control">
                            <button class="button is-link">Rechercher</button>
                        </div>
                    </div>
                </form>
            {% endif %}
            <br>

            {% if pagination.getTotalItemCount == 0 and query != '' %}
                <article class="message is-danger">
                    <div class="message-body">
                        Aucun résultat ne correspond à <strong> {{ query }}</strong>.
                    </div>
                </article>
            {% endif %}


            {% if pagination.getTotalItemCount > 0 %}
                {% for quote in pagination %}
                    {% if loop.index0 is divisible by(3) %}
                        <div class="tile is-ancestor">
                    {% endif %}
                    <div class="tile is-parent" data-aos="fade-up">
                        <article class="tile is-child box">
                            {% for catg in quote.categorie %}
                                <span class="tag is-success is-normal">{{catg.name | capitalize}}</span>
                            {% endfor %}
                            <br>
                            <span class="tag is-warning"> Créé par {{ quote.author.username }}</span>
                            <p class="title">{{quote.content}}</p>
                            <p class="subtitle">{{quote.meta|capitalize}}</p>
                            {% if is_granted('quotes_edit',quote) %}
                                <a class="button is-info is-rounded " href="{{ path('quotes_edit',{'id': quote.id}) }}">Modifier
                                    &nbsp;<i class="far fa-edit"></i></a>
                                <a class="button is-danger is-rounded is-light"
                                   href="{{ path('quotes_delete', { 'id': quote.id }) }}">Supprimer &nbsp;<i
                                            class="fas fa-trash"></i></a>
                            {% endif %}
                        </article>
                    </div>
                    {% if loop.index is divisible by(3) or loop.last %}
                        </div>
                    {% endif %}
                {% endfor %}
            {% elseif pagination.getTotalItemCount == 0 and query== ''  %}
                <article class="message is-danger">
                    <div class="message-body">
                        Aucune citation n'a été trouvé. Veuillez ajouter une citation pour la voir apparaitre.
                    </div>
                </article>
            {% endif %}
            <div class="navigation">
                {{ knp_pagination_render(pagination) }}
            </div>

        </div>
        <div class="column">
        </div>
    </div>
{% endblock %}